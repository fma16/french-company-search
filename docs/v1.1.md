# Plan de Développement v1.1

## TODO List v1.1

- [ ] Intégrer une liste de vrais SIREN dans les procédures de test.
- [ ] Inverser la capitalisation du nom et prénom du responsable légal.
- [ ] Ne pas mettre en capitales la ville du RCS.
- [ ] Mieux formater les adresses.

---

Ce document détaille les étapes de développement prévues pour la version 1.1 de l'extension, en se basant sur les fonctionnalités demandées.

## 1. Intégrer une liste de vrais SIREN dans les tests

**Objectif :** Améliorer la fiabilité des tests en utilisant des données d'entreprises réelles et variées.

### Analyse

- Les tests d'intégration se trouvent probablement dans `src/__tests__/integration/`. Le fichier `basic-services.integration.test.ts` est un bon candidat.
- Actuellement, les SIREN de test sont soit inexistants, soit codés en dur et peu nombreux.

### Implémentation

1.  **Collecter des SIREN :** Constituer une liste d'une dizaine de numéros SIREN valides et publics, représentant différents types d'entreprises (personne physique, grande entreprise, PME, radiée, etc.).
2.  **Stocker les SIREN :** Créer un fichier de données de test, par exemple `src/__tests__/data/siren-list.json`, pour stocker cette liste.
3.  **Mettre à jour les tests :** Modifier les tests d'intégration pour lire les SIREN depuis ce fichier et boucler dessus, afin d'exécuter les mêmes validations pour chaque entreprise.

### Vérification

- Lancer la suite de tests avec `npm test` (ou la commande de test configurée dans `package.json`).
- S'assurer que tous les tests passent avec succès pour l'ensemble des SIREN de la liste.

## 2. Inverser la capitalisation du nom et prénom du responsable légal

**Objectif :** Afficher le nom du responsable au format `Prénom NOM`.

### Analyse

- Le formatage des données semble être centralisé dans `src/utils/formatting.ts`.
- L'affichage est géré par les composants React, probablement `src/components/CompanyDetailsView.tsx` ou `src/components/CompanyMetadata.tsx`.
- La logique de transformation est probablement dans une fonction de `src/utils/formatting.ts` qui est ensuite appelée par le composant.

### Implémentation

1.  **Identifier la fonction :** Localiser la fonction de formatage du nom dans `src/utils/formatting.ts`.
2.  **Modifier la logique :**
    - Séparer le nom complet en prénom(s) et nom de famille.
    - Appliquer la capitalisation : `prénom` -> `Prénom` (première lettre en majuscule, le reste en minuscules) et `nom` -> `NOM` (tout en majuscules).
3.  **Créer un test unitaire :** Ajouter un cas de test dans `src/utils/__tests__/utils.test.ts` pour valider cette nouvelle logique de formatage.

### Vérification

- Exécuter les tests unitaires.
- Lancer l'extension et vérifier visuellement le format du nom sur la page de détails d'une entreprise.

## 3. Ne pas mettre en capitales la ville du RCS

**Objectif :** Afficher la ville du greffe du RCS en casse de titre (ex: `Paris` au lieu de `PARIS`).

### Analyse

- Similaire au point précédent, la logique de formatage de la chaîne "RCS" se trouve certainement dans `src/utils/formatting.ts`.

### Implémentation

1.  **Identifier la fonction :** Trouver la fonction qui formate la chaîne contenant le RCS et la ville.
2.  **Modifier la logique :** Isoler la partie de la chaîne correspondant à la ville et la transformer pour n'avoir que la première lettre en majuscule (`Ville`).
3.  **Mettre à jour le test :** Ajouter ou modifier un test dans `src/utils/__tests__/utils.test.ts` pour couvrir ce cas.

### Vérification

- Exécuter les tests unitaires.
- Vérifier visuellement le résultat dans l'interface de l'extension.

## 4. Mieux formater les adresses

**Objectif :** Standardiser l'affichage des adresses postales selon les conventions françaises (casse et abréviations).

### Analyse

- C'est la tâche la plus complexe. Elle nécessite une transformation structurée des adresses qui sont actuellement en majuscules et avec des abréviations.
- La logigue appartiendra à `src/utils/formatting.ts`.

### Implémentation

1.  **Créer un dictionnaire d'abréviations :**
    - Créer un fichier de mapping, par exemple `src/config/address-mappings.json`.
    - Y lister les abréviations courantes et leur forme complète (ex: `"BD": "Boulevard"`, `"AV": "Avenue"`, `"RTE": "Route"`, `"CHE": "Chemin"`, `"PL": "Place"`...).
2.  **Développer la fonction de formatage :**
    - Dans `src/utils/formatting.ts`, créer une nouvelle fonction `formatAddress`.
    - La fonction devra :
        a. Mettre toute l'adresse en minuscules.
        b. Remplacer les abréviations par leur forme complète en se basant sur le dictionnaire.
        c. Mettre en majuscule la première lettre de chaque mot significatif (Title Case), en ignorant potentiellement les petits mots comme "de", "la", "le".
3.  **Intégrer la fonction :** Appeler `formatAddress` depuis le composant qui affiche l'adresse (`CompanyDetailsView.tsx`).
4.  **Ajouter des tests :** Créer une série de tests dans `src/utils/__tests__/utils.test.ts` avec différentes adresses pour valider la robustesse de la fonction.

### Vérification

- Exécuter la suite de tests.
- Tester manuellement l'affichage avec plusieurs entreprises ayant des adresses différentes pour s'assurer que le formatage est correct et ne produit pas d'erreurs.
